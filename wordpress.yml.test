---
- hosts: dev
  become: yes
  remote_user: ec2-user
  tasks:
    - name: wait for server to start
      local_action:
        module: wait_for
          host=dev
          port=22
          delay=1
          timeout=300
    - name: Install Apache.
      yum: name={{ item }} state=present
      with_items:
      - httpd
      - php
      - php-mysql
    - name: Make sure Apache is started now and at boot. 
      service: name=httpd state=started enabled=yes
    - name: Download WordPress
      get_url: url=http://wordpress.org/wordpress-latest.tar.gz dest=/var/www/html/wordpress.tar.gz force=yes
    - name: Extract archive
      unarchive: src=/var/www/html/wordpress.tar.gz dest=/var/www/html copy=no
    - command: mkdir -p /var/www/html && cd /var/www/html/ && cp /var/www/wordpress/* /var/www/html/. 
    - name: Make sure Apache is started now and at boot.
      service: name=httpd state=started enabled=yes
   






